{"version":3,"sources":["./src/app/pages/page-map/page-map.component.ts","./src/app/pages/page-map/page-map.component.html","./src/app/pages/page-map/page-map.module.ts","./src/app/shared/services/map/map.service.ts"],"names":[],"mappings":"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","file":"pages-page-map-page-map-module.js","sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { combineLatest } from 'rxjs';\nimport { BackendService } from 'src/app/shared/services/backend/backend.service';\nimport { MapPinItem } from '../../shared/interfaces/map-pin-item';\nimport { MapService } from '../../shared/services/map/map.service';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { MapPointItem } from 'src/app/shared/interfaces/map-point-item';\n\n\n@UntilDestroy()\n@Component({\n  selector: 'app-page-map',\n  templateUrl: './page-map.component.html',\n  styleUrls: ['./page-map.component.scss']\n})\nexport class PageMapComponent implements OnInit, OnDestroy {\n  public pointList: MapPointItem[];\n  public heatMapData: [number, number][];\n  public mapPinItems: MapPinItem[] = [\n    {\n      id: 1,\n      name: 'item 1',\n      map: [55.8077124955766, 37.843035477866]\n    }\n  ];\n\n\n  constructor(\n    private mapService: MapService,\n    private backendService: BackendService,\n  ) { }\n\n\n  public ngOnInit(): void {\n    this.loadData();\n  }\n\n  public ngOnDestroy(): void {\n  }\n\n\n  private loadData(): void {\n    const loadPointList = this.backendService.getData<MapPointItem[]>('point.getList');\n    combineLatest([loadPointList])\n      .pipe(untilDestroyed(this))\n      .subscribe(([pointList]) => {\n        // this.pointList = pointList;\n        this.heatMapData = pointList.map(item => {\n          return [item.lat, item.lon];\n        });\n      });\n  }\n\n}\n","<div *ngIf=\"heatMapData\">\n  <!--<app-yandex-heat-map [heatMapData]=\"heatMapData\"></app-yandex-heat-map>-->\n  <app-pie-chart\n    [labels]=\"['Жен.', 'Муж.']\"\n    [series]=\"[18076, 9785]\"\n    [colors]=\"['#DF4C4A', '#80BD00']\"\n  ></app-pie-chart>\n\n  <app-pie-chart\n    [labels]=\"['<7', '7-18', '18-25', '25-45', '45-60', '60-75', '75-90', '90<']\"\n    [series]=\"[280, 2261, 642, 2532, 3952, 13175, 4517, 502]\"\n  ></app-pie-chart>\n\n  <app-pie-chart\n    [labels]=\"['Многодетные', 'Беременность', 'Инвалид', 'Малоимущие', 'Пенсионер', 'Ветеран труда', 'Дети инвалиды', 'Молодые родители']\"\n    [series]=\"[2642, 365, 5144, 833, 12507, 5383, 332, 655]\"\n  ></app-pie-chart>\n</div>\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { PageMapComponent } from './page-map.component';\nimport { RouterModule } from '@angular/router';\nimport { YandexHeatMapModule } from '../../shared/components/yandex-heat-map/yandex-heat-map.module';\nimport { PieChartModule } from '../../shared/components/pie-chart/pie-chart.module';\n\n\n\n@NgModule({\n  declarations: [PageMapComponent],\n  imports: [\n    CommonModule,\n    RouterModule.forChild([{path: '', component: PageMapComponent}]),\n    YandexHeatMapModule,\n    PieChartModule\n  ]\n})\nexport class PageMapModule { }\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class MapService {\n  private EKVL = 40076 / 360;\n  // private readonly PI = 3.14159265359;\n\n  constructor() { }\n\n\n  public geoDistance(lat1: number, lon1: number, lat2: number, lon2: number): number {\n    const theta = lon1 - lon2;\n    let dist = Math.sin(this.deg2rad(lat1)) * Math.sin(this.deg2rad(lat2)) + Math.cos(this.deg2rad(lat1)) * Math.cos(this.deg2rad(lat2)) * Math.cos(this.deg2rad(theta));\n    dist = this.rad2deg(Math.acos(dist));\n\n    return dist * this.EKVL;\n  }\n\n\n  public deg2rad(deg: number): number {\n    return deg * Math.PI / 180;\n  }\n\n\n  public rad2deg(rad: number): number {\n    return rad * 180 / Math.PI;\n  }\n}\n"],"sourceRoot":"webpack:///"}